<div class="row-fluid">
	<div class="span2 offset5">
		<h4>Projet :</h4>
		<select class="form-control" id="selectProjectDC" onChange="majSelectedDC();"></select>
	</div>
</div>
<div class="row-fluid">
    <canvas id="canvasDoughnut"></canvas>
</div>

<script src="vendors/Chart.js/dist/Chart.min.js"></script>

<script>
	function majProjetsDC(){
		$("#selectProjectDC").empty();

		$.getJSON("http://localhost/Developement/queries/parametres.php?objet=projets", function(data){
			if(jQuery.parseJSON(data.data) !== false)
			jQuery.parseJSON(data.data).forEach(function (currentValue) {
				$("#selectProjectDC").append("<option value='" + currentValue.codeProjet + "'>" + currentValue.libelleProjet + "</option>");
			});
	        $.ajax({
	            type: "GET",
	            url: "http://localhost/Developement/queries/maj_session.php?projetEnCours=bite",
	            success : function(data){
	                $("#selectProjectDC").val(jQuery.parseJSON(data).data);
            		fillDonut();
	            }
	        });
		});
	}

    function majSelectedDC(){
        $.ajax({
            type: "POST",
            url: "http://localhost/Developement/queries/maj_session.php",
            data: {
                projetEnCours: $("#selectProjectDC").val()
            },
            success: function(){
            	fillDonut();
            }
        });
    }

	majProjetsDC();

	function fillDonut(){
		var ctx = document.getElementById("canvasDoughnut");
		var data = {
			labels: [
				"Dark Grey",
				"Purple Color",
				"Gray Color",
				"Green Color",
				"Blue Color"
			],
			datasets: [{
				data: [120, 50, 140, 180, 100],
				backgroundColor: [
					"#455C73",
					"#9B59B6",
					"#BDC3C7",
					"#26B99A",
					"#3498DB"
				],
				hoverBackgroundColor: [
					"#34495E",
					"#B370CF",
					"#CFD4D8",
					"#36CAAB",
					"#49A9EA"
				]

			}]
		};

		var canvasDoughnut = new Chart(ctx, {
			type: 'doughnut',
			tooltipFillColor: "rgba(51, 51, 51, 0.55)",
			data: data
		});
	}
</script>